<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- The above 4 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    

    <!-- Title  -->
    <title>NUNA PROJECT ART - $NUNA Token is a token for art. NUNA TOKEN, STELLAR NETWORK, ART, NFT, APP, WEB3.</title>

    <!-- Favicon  -->
    <link rel="icon" href="assets/img/favicon.ico">

    <!-- ***** All CSS Files ***** -->

    <!-- Style css -->
    <link rel="stylesheet" href="assets/css/style.css">

</head>

<body>
    <!--====== Preloader Area Start ======-->
    <div id="gameon-preloader" class="gameon-preloader">
        <!-- Preloader Animation -->
        <div class="preloader-animation">
            <!-- Spinner -->
            <div class="spinner"></div>
            <p class="fw-5 text-center text-uppercase">Wait for art...</p>
        </div>
        <!-- Loader Animation -->
        <div class="loader-animation">
            <div class="row h-100">
                <!-- Single Loader -->
                <div class="col-3 single-loader p-0">
                    <div class="loader-bg"></div>
                </div>
                <!-- Single Loader -->
                <div class="col-3 single-loader p-0">
                    <div class="loader-bg"></div>
                </div>
                <!-- Single Loader -->
                <div class="col-3 single-loader p-0">
                    <div class="loader-bg"></div>
                </div>
                <!-- Single Loader -->
                <div class="col-3 single-loader p-0">
                    <div class="loader-bg"></div>
                </div>
            </div>
        </div>
    </div>
    <!--====== Preloader Area End ======-->

    <div class="main">
        <!-- ***** Header Start ***** -->
        <header id="header">
            <!-- Navbar -->
            <nav data-aos="zoom-out" data-aos-delay="800" class="navbar gameon-navbar navbar-expand">
                <div class="container header">

                    <!-- Logo -->
                    <a class="navbar-brand" href="index.html">
                        <img src="assets/img/logo/logo.png" alt="Brand Logo" />
                    </a>

                    <div class="ml-auto"></div>

                    <!-- Navbar Nav -->
                    <ul class="navbar-nav items mx-auto">
                        <li class="nav-item active">
                            <a href="index.html" class="nav-link active">NUNA</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link">Projects <i class="icon-arrow-down"></i></a>
                            <ul class="dropdown-menu">
                                <li class="nav-item">
                                    <a href="https://nunaprojectart.medium.com/introducing-nuna-project-art-7c26619a95" target="_blank" class="nav-link">What is $NUNA?</a>
                                </li>
                                <li class="nav-item">
                                    <a href="https://nunaprojectart.medium.com/nuna-nft-club-e2bbc2182e9a" target="_blank" class="nav-link">Nuna Club</a>
                                </li>
                                <li class="nav-item">
                                    <a href="https://nunaprojectart.medium.com/nuna-reimbursement-system-3dff989c322a" target="_blank" class="nav-link">Reimbursement System</a>
                                </li>
                                <li class="nav-item">
                                    <a href="https://nunaprojectart.medium.com/stellar-artistic-foundation-online-artistic-residence-9f059aac9a17" target="_blank" class="nav-link">Stellar Artistic Foundation</a>
                                </li>
                               
                            </ul>
                        </li>
                        <li class="nav-item dropdown">
                            <a href="staking.html" target="_blank" class="nav-link">Staking</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a href="farming.html" target="_blank" class="nav-link">LP Rewards</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link">More<i class="icon-arrow-down"></i></a>
                            <ul class="dropdown-menu">
                                <li class="nav-item dropdown">
                                    <a href="#" class="nav-link">Help <i class="icon-arrow-right"></i></a>
                                    <ul class="dropdown-menu">
                                        
                                        <li class="nav-item">
                                            <a href="wallet-connect.html" class="nav-link">Wallets to use</a>
                                        </li>
                                        <li class="nav-item">
                                            <a href="help-center.html" class="nav-link">FAQs</a>
                                        </li>
                                        
                                    </ul>
                                </li>
                              
                                <li class="nav-item">
                                    <a href="tokenomics.html" class="nav-link">Tokenomics</a>
                                </li>
                            
                                <li class="nav-item dropdown">
                                    <a href="blog.html" class="nav-link">Instructions</a>
                                
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item">
                            <a href="contact.html" class="nav-link">Contact</a>
                        </li>
                    </ul>
                        <!-- Navbar Toggler -->
                    <ul class="navbar-nav toggle">
                            <li class="nav-item">
                                <a href="#" class="nav-link" data-toggle="modal" data-target="#menu">
                                    <i class="icon-menu m-0"></i>
                                    
                                </a>
                            </li>
                        </ul>

                    <!-- Navbar Action Button -->
                    <ul class="navbar-nav action">
                        <li class="nav-item ml-2">
                            <button onclick="login_with_albedo()"  class="btn ml-lg-auto btn-bordered-white">Albedo</button>
                            <button onclick="login_with_rabet()"  class="btn ml-lg-auto btn-bordered-white">Rabet</button>
                            <button onclick="login_with_freighter()"  class="btn ml-lg-auto btn-bordered-white">Freighter</button>
                        </li>
                    </ul>

                </div>
            </nav>
        </header>
        <!-- <button onclick="login_with_albedo()">Albedo</button>
        <button onclick="login_with_rabet()">Rabet</button>
        <button onclick="login_with_freighter()">Freighter</button> -->
        <!-- ***** Header End ***** -->
        <!-- ***** Breadcrumb Area Start ***** -->
        <section class="breadcrumb-area overlay-dark d-flex align-items-center">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <!-- Breamcrumb Content -->
                        <div class="breadcrumb-content text-center">
                            <h2 class="m-0">NUNA Staking (Coming Soon)</h2>
                            <ol class="breadcrumb d-flex justify-content-center">
                                <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                                
                                <li class="breadcrumb-item active">NUNA Staking</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- ***** Breadcrumb Area End ***** -->

        <!-- ***** Staking Area Start ***** -->
        <section class="staking-area">
            <div class="container">
                <div class="row">
                    <div class="col-12 col-md-7">
                        <div class="card no-hover staking-card single-staking">
                            <h3 class="m-0">NUNA Staking (Coming Soon)</h3>
                            <ul class="nav nav-tabs staking-tabs border-0 my-3 my-md-4" id="myTab" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <a class="tab-link active" id="tab-one-tab" data-toggle="tab" href="#tab-one" role="tab" aria-controls="tab-one" aria-selected="true">Short Term</a>
                                </li>
                                <li class="nav-item" role="presentation">
                                </li>
                               
                               
                            </ul>
                            <div class="tab-content mt-md-3" id="myTabContent">
                                <div class="tab-pane fade show active" id="tab-one" role="tabpanel" aria-labelledby="tab-one-tab">
                                    <div class="staking-tab-content">
                                        <!-- Info Box -->
                                        <div class="info-box d-flex justify-content-between">
                                            <div class="info-left">
                                                <ul class="list-unstyled">
                                    
                                                    <li><strong>Status:</strong> Unlocked</li>
                                                </ul>
                                            </div>
                                            <div class="info-right d-flex flex-column">
                                                <span id="apy">...%</span>
                                                <span>APY*</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="tab-two" role="tabpanel" aria-labelledby="tab-two-tab">
                                    <div class="staking-tab-content">
                                 
                                       
                                        <!-- Info Box -->
                                        <div class="info-box d-flex justify-content-between">
                                            <div class="info-left">
                                                <ul class="list-unstyled">
                                                    <li><strong>Status:</strong> Locked</li>
                                                </ul>
                                            </div>
                                            <div class="info-right d-flex flex-column">
                                                <span>...%</span>
                                                <span>APY*</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="input-box my-4">
                                <div class="input-area d-flex flex-column flex-md-row mb-3">
                                    <div class="input-text">
                                        <input id="stake_input" type="number" placeholder="NUNA Stake Amount">
                                    </div>
                                    <button onclick="create_staking_tx()" class="btn input-btn mt-2 mt-md-0 ml-md-3">stake</button>
                                </div>
                                <div class="input-area d-flex flex-column flex-md-row">
                                    <div class="input-text">
                                     
                                    </div>
                                    <button onclick="unstake()" class="btn input-btn mt-2 mt-md-0 ml-md-3">Unstake</button>
                                </div>
                            </div>
                            <span id="error">Stake your NUNA tokens to earn more.</span>
                            <span class="mt-3"><strong>*APY is dynamic.</strong></span>
                            <pre id="horizon_error"></pre>
                        </div>
                    </div>
                    <div class="col-12 col-md-5">
                        <div class="staking-items mt-4 mt-md-0">
                            <!-- Single Card -->
                            <div class="card no-hover staking-card">
                                <h3 class="m-0" id="tvl">$...</h3>
                                <p>Total Value Locked</p>
                            </div>
                            <!-- Single Card -->
                            <div class="card no-hover staking-card my-4">
                                <h3 class="m-0" id="total">...</h3>
                                <p>Staked $NUNA</p>
                            </div>
                            
                            <!-- Single Card -->
                            <div class="card no-hover staking-card">
                                <h3 class="m-0" id="num_stakers">...</h3>
                                <p>Number of Stakers</p>
                            </div>
                            <div class="card no-hover staking-card my-4">
                                <h3 class="m-0"  id="my_staked">...</h3>
                                <p>My Staked $NUNA</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- ***** Staking Area End ***** -->

       



         <!--====== Footer Area Start ======-->
         <footer class="footer-area">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-12 col-md-8 text-center">
                        <!-- Footer Items -->
                        <div class="footer-items">
                            <!-- Logo -->
                            <a class="navbar-brand" href="index.html">
                                <img src="assets/img/logo/logo.png" alt="">
                            </a>
                            <!-- Social Icons -->
                            <div class="social-icons d-flex justify-content-center my-4">
                            
                                </a>
                                <a class="twitter" href="https://twitter.com/nunaprojectart" target="_blank">
                                    <i class="fa-brands fa-twitter"></i>
                                    
                                </a>
                                <a class="linkedin" href="https://linktr.ee/nunaprojectart" target="_blank">
                                    <i class="fa-brands fa-envira"></i>

                                </a>
                                <a class="reddit" href="https://t.me/NunaProjectArt" target="_blank">
                                    <i class="fab fa-telegram"></i>
                                   
                                </a>
                                <a class="vkontakte" href="https://discord.gg/RshXa7bYyQ" target="_blank">
                                    <i class="fab fa-discord"></i>
                                    
                                </a>
                                <a class="youtube" href="https://nunaprojectart.medium.com/" target="_blank">
                                    <i class="fa-brands fa-medium"></i>
                                </a>
                            </div>
                            <ul class="list-inline">
                                <li class="list-inline-item"><a href="wallet-connect.html">Wallet to Connect</a></li>
                                <li class="list-inline-item"><a href="tokenomics.html">Tokenomics</a></li>
                              
                                <li class="list-inline-item"><a href="blog.html">Instructions</a></li>
                                <li class="list-inline-item"><a href="staking-1.html">Staking</a></li>
                            </ul>
                            <!-- Copyright Area -->
                            <div class="copyright-area py-4">&copy;2022 NUNA PROJECT <a href="https://nunaproject.art/images/icono/nuna-exlibris.png" target="_blank">ART</a></div>
                        </div>
                        <!-- Scroll To Top -->
                        <div id="scroll-to-top" class="scroll-to-top">
                            <a href="#header" class="smooth-anchor">
                                <i class="fa-solid fa-arrow-up"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
        <!--====== Footer Area End ======-->

       

        <!--====== Modal Responsive Menu Area Start ======-->
        <div id="menu" class="modal fade p-0">
            <div class="modal-dialog dialog-animated">
                <div class="modal-content h-100">
                    <div class="modal-header" data-dismiss="modal">
                        Menu <i class="far fa-times-circle icon-close"></i>
                    </div>
                    <div class="menu modal-body">
                        <div class="row w-100">
                            <div class="items p-0 col-12 text-center"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--====== Modal Responsive Menu Area End ======-->

    </div>


    <!-- ***** All jQuery Plugins ***** -->

    <!-- jQuery(necessary for all JavaScript plugins) -->
    <script src="assets/js/vendor/jquery.min.js"></script>

    <!-- Bootstrap js -->
    <script src="assets/js/vendor/popper.min.js"></script>
    <script src="assets/js/vendor/bootstrap.min.js"></script>

    <!-- Plugins js -->
    <script src="assets/js/vendor/all.min.js"></script>
    <script src="assets/js/vendor/gallery.min.js"></script>
    <script src="assets/js/vendor/slider.min.js"></script>
    <script src="assets/js/vendor/countdown.min.js"></script>
    <script src="assets/js/vendor/shuffle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.1.3/axios.min.js" integrity="sha512-0qU9M9jfqPw6FKkPafM3gy2CBAvUWnYVOfNPDYKVuRTel1PrciTj+a9P3loJB+j0QmN2Y0JYQmkBBS8W+mbezg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- Active js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stellar-freighter-api/1.1.2/index.min.js"></script>
    <script src="https://unpkg.com/@albedo-link/intent/lib/albedo.intent.js"></script>
    <script src="assets/js/main.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stellar-sdk/10.4.0/stellar-sdk.min.js" integrity="sha512-g0SxqTuQm5hTkD9sk4DMT3tfrZV5QM+pbChv9vhQHIG+6H1hZXEI7Gz017ciPb3gIznqXv83zOBmBa1+l9fXcw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script>
        
        const config = {
            asset_code : "NUNA",
            asset_issuer : "GCX2ENOVSSOOH6G4HIOBMPCBFXHDVDGA546NK3ZFX3NP3QS25BKZBWOW",
            testnet : false,
            contract_address : "GAKFSPSLDGQE6CVJB53LYRZ7L5JKBOQQPZPMB32MPEXDRWBGVZV5WXNI",
            daily_reward_amount : 100000,
            price_url : "https://horizon.stellar.org/paths/strict-send?source_asset_code=NUNA&source_asset_issuer=GCX2ENOVSSOOH6G4HIOBMPCBFXHDVDGA546NK3ZFX3NP3QS25BKZBWOW&source_asset_type=credit_alphanum12&source_amount=1000&destination_assets=USDC:GA5ZSEJYB37JRC5AVCIA5MOP4RHTM335X2KGX3IHOJAPP5RE34K4KZVN&limit=1",    
            lock_time_seconds : 2593000,
            valid_after_seconds : 2592000,
        }
        pass = ""
        if (config.testnet){
            config.horizon = "https://horizon-testnet.stellar.org";
            pass = "Test SDF Network ; September 2015"
        }
        else{
            config.horizon = "https://horizon.stellar.org"
            pass = "Public Global Stellar Network ; September 2015"
        }
        
        
        let wallet = ""
        let pubkey = ""
        
        const server = new StellarSdk.Server(config.horizon);
        
      

        async function get_staking_transactions(){
            next = true
            total_staked = 0
            staker_list = []
            resp = await server.claimableBalances()
        
                .claimant(config.contract_address)
                .asset(new StellarSdk.Asset(config.asset_code,config.asset_issuer))
                .limit(200)
                .call()
            while(next){
                if(resp.records.length > 0){
                    resp.records.forEach(element => {
                        if(resolve_claimants(element)){
                            total_staked += parseFloat(element.amount)
                        staker_list.push(element.sponsor)
                        }
                        
                    });
                    resp = await resp.next()
                }
                else{
                    break
                }
            }
            var price = 0
            await axios.get(config.price_url).then(response => {
                price = parseFloat(response.data._embedded.records[0].destination_amount)
            })
            document.getElementById('tvl').innerHTML = "$" + Number(total_staked*(price/1000)).toFixed(5)
            document.getElementById('num_stakers').innerHTML = new Set(staker_list).size
            document.getElementById('apy').innerHTML = (Math.round((config.daily_reward_amount/total_staked)*365*100)) + "%"
            document.getElementById('total').innerHTML = total_staked
        }
        
        async function get_my_staked(){
            my_staked = 0
            resp = await server.claimableBalances()
        
                .claimant(config.contract_address)
                .asset(new StellarSdk.Asset(config.asset_code,config.asset_issuer))
                .sponsor(pubkey)
                .limit(200)
                .call()
        
            resp.records.forEach(element => {
                if(resolve_claimants(element)){
                my_staked += parseFloat(element.amount)
            }
            
            })
            document.getElementById('my_staked').innerHTML = my_staked + " with " + resp.records.length + " deposits"
        
        }
        
        async function login_with_freighter(){
            if (window.freighterApi.isConnected()) {
                pubkey = await window.freighterApi.getPublicKey()
                wallet = "freighter"
                document.getElementById('error').innerHTML = "logged in with address: " + pubkey.slice(0,5) + "..." + pubkey.slice(50,56) + " with " + wallet
                get_my_staked(pubkey)
            }
    
        }
        
        async function login_with_albedo(){
            await albedo.publicKey({token:"pvH76KjqLIVZcG+XDWPn63+sWBsWvAOzZgHvHMG5mYM="})
            .then(res => {
                pubkey = res.pubkey;
                wallet = "albedo";
        
            })
            if(pubkey != ""){
                document.getElementById('error').innerHTML = "logged in with address: " + pubkey.slice(0,5) + "..." + pubkey.slice(50,56) + " with " + wallet
                get_my_staked(pubkey)
        
            }
        }
        
        async function login_with_rabet(){
            if (window.rabet) {
                rabet.connect()
                .then(result => {
                    pubkey = result.publicKey
                    wallet = "rabet"
                    document.getElementById('error').innerHTML = "logged in with address: " + pubkey.slice(0,5) + "..." + pubkey.slice(50,56) + " with " + wallet
                    get_my_staked(pubkey)

                })
                .catch(error => console.error(`Error: ${error}`));
            }
        }

        async function create_staking_tx(){
            document.getElementById('horizon_error').innerHTML = ""
            let signed_tx = ""
            amt = document.getElementById('stake_input').value
            if(wallet === "" || pubkey === ""){
                document.getElementById('error').innerHTML = "Please Login!"
            }
            else{
                    if(document.getElementById('error').innerHTML != ""){document.getElementById('error').innerHTML = ""}
                    else if(document.getElementById('stake_input').value == ""){document.getElementById('error').innerHTML = "Staked amount input was left blank"}
                    else{
                        const account = await server.loadAccount(pubkey)
                        const fee = 500000
                        const transaction = new StellarSdk.TransactionBuilder(account, {
                             fee : fee,
                             networkPassphrase : pass
                            })
                        .setTimeout(100)
                        .addOperation(
                            StellarSdk.Operation.createClaimableBalance({
                                asset : new StellarSdk.Asset(config.asset_code,config.asset_issuer),
                                amount : document.getElementById('stake_input').value,
                                claimants : [
                                    new StellarSdk.Claimant(config.contract_address),
                                    new StellarSdk.Claimant(pubkey, StellarSdk.Claimant.predicateNot(StellarSdk.Claimant.predicateBeforeRelativeTime(String(config.lock_time_seconds)))
                                    )
                                ],
        
                            })
                        
                        )
                        xdr = transaction.build().toXDR()
                        console.log(wallet)
                        if(wallet==="albedo"){
                            sub = ""
                            x = ""
                            if(config.testnet){
                                x = "testnet"
                            }
                            else{x="public"}
                            await albedo.tx({
                                xdr: xdr,
                                network: x
                            })
                                .then( res =>
                                signed_tx = res.signed_envelope_xdr
                                )
                        }
                        else if (wallet === "freighter"){
                            net = ""
                            if (config.testnet){
                                net = "TESTNET"
                            }
                            else{
                                net = "PUBLIC"
                            }
                            console.log(net)
                            signed_tx = await await window.freighterApi.signTransaction(xdr,net,pubkey);
                        }
                        else if (wallet === "rabet"){
                            net = ""
                            if (config.testnet){
                                net = "testnet"
                            }
                            else{
                                net="mainnet"
                            }
                        console.log(wallet)
                        console.log(pubkey)
                        await rabet.sign(xdr, net)
                            .then(result => signed_tx = result.xdr)
                            .catch(error => console.error(`Error: ${error.message}`));
                        }
                    }
                       

                }
            if (signed_tx.length > 0){
                console.log(signed_tx)
            try{
                document.getElementById('error').innerHTML = "Submitting to horizon..."
                await server.submitTransaction(new StellarSdk.TransactionBuilder.fromXDR(signed_tx,pass))
            document.getElementById('error').innerHTML = "Successfully staked " + amt + " NUNA"
            get_my_staked()
            get_staking_transactions()
        }
            catch(e){
                console.log(e.response.data)
                document.getElementById('horizon_error').innerHTML =JSON.stringify(e.response.data.extras.result_codes,undefined,2)
            }
        }
    }
        
        // Evaluating a valid staking transaction;
        //  - Must have 2 claimants
        //  - One claimant must be the contract address, and must be unconditional
        //  - The other claimant must be self
        //      - Predicate must only have a "NOT", with abs_before set to a valid date. (Only one predicate)
        //      - TimeDelta between the abs_before and the submitted ledger time must be 30 days or more.
        
        function resolve_claimants(claimable){
            if(claimable.claimants[0].destination === config.contract_address && claimable.claimants[0].predicate.unconditional  && claimable.claimants.length == 2){
                diff = new Date(claimable.claimants[1].predicate.not.abs_before) - new Date(claimable.last_modified_time)
                if(diff >= config.valid_after_seconds*1000){
                    return true
                }
            }
            return false
        }
        
        function resolve_pending(claimable,now_time){
            if(claimable.claimants[0].destination === config.contract_address && claimable.claimants[0].predicate.unconditional && claimable.claimants.length == 2){
                valid_after = new Date(claimable.claimants[1].predicate.not.abs_before)
                if(now_time - valid_after > 0){return true}
        
            }
            return false
        }
        
        async function unstake(){
            document.getElementById('horizon_error').innerHTML = ""
            if (pubkey === ""){document.getElementById('error').innerHTML = "Please login!" }
            else{
            claims = []
            unstaking = 0
            resp = await server.claimableBalances()
        
                .claimant(config.contract_address)
                .asset(new StellarSdk.Asset(config.asset_code,config.asset_issuer))
                .sponsor(pubkey)
                .limit(100)
                .call()
            now = new Date()
            resp.records.forEach(element => {
                    if(resolve_claimants(element) && resolve_pending(element,now)){
                        claims.push(element.id)
                        unstaking += parseFloat(element.amount)
            }   
            })
            console.log(claims.length)

            if(claims.length > 0){
                const account = await server.loadAccount(pubkey)
                const fee = 500000
                let signed_tx = ""
                const transaction = new StellarSdk.TransactionBuilder(account, {
                     fee : fee,
                     networkPassphrase : pass
                    })
                .setTimeout(100)
                claims.forEach(bal_id => {
                    transaction.addOperation(StellarSdk.Operation.claimClaimableBalance({balanceId:bal_id}))
                })
                xdr = transaction.build().toXDR()
                if(wallet==="albedo"){
                    sub = ""
                    x = ""
                    if(config.testnet){
                        x = "testnet"
                    }
                    else{x="public"}
                    await albedo.tx({
                        xdr: xdr,
                        network: x
                    })
                        .then( res =>{
                        signed_tx = res.signed_envelope_xdr
                    }
                        )
                }    
                else if (wallet === "rabet"){
                    net = ""
                    if (config.testnet){
                        net = "testnet"
                    }
                    else{
                        net="mainnet"
                    }
                await rabet.sign(xdr, net)
                    .then(result => signed_tx = result.xdr)
                    .catch(error => console.error(`Error: ${error.message}`));
                }
                else if (wallet === "freighter"){
                    net = ""
                    if (config.testnet){
                        net = "TESTNET"
                    }
                    else{
                        net = "PUBLIC"
                    }
                    console.log(net)
                    signed_tx = await await window.freighterApi.signTransaction(xdr,net,pubkey);
                }
                if (signed_tx.length > 0){
                    console.log(signed_tx)
                try{
                    document.getElementById('error').innerHTML = "Submitting to horizon..."

                await server.submitTransaction(new StellarSdk.TransactionBuilder.fromXDR(signed_tx,pass))
                document.getElementById('error').innerHTML = "Successfully staked " + amt + " NUNA"
                get_my_staked()
                get_staking_transactions()
            }
                catch(e){
                    console.log(e)
                    document.getElementById('horizon_error').innerHTML =JSON.stringify(e.response.data.extras.result_codes,undefined,2)
                }
            }
        }
        else{
            document.getElementById('horizon_error').innerHTML = "No deposits available for unstake"
        }
    }
}
        get_staking_transactions()
    </script>
</body>

</html>
